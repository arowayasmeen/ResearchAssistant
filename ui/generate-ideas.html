<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ResearchAssistant - Idea Generation</title>
    <link rel="stylesheet" href="css/ideas.css">

</head>
<body>
    <div class="sidebar">
        <div class="sidebar-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
            </svg>
            <span class="tooltip">Home</span>
        </div>
        <div class="sidebar-icon">
            <img src="images/spyglass.png" alt="spyglass" class="icon-image">
            <span class="tooltip">Literature Review</span>
        </div> 
        <div class="sidebar-icon">
            <img src="images/helm.png" alt="helm" class="icon-image">
            <span class="tooltip">Generate Ideas</span>
        </div>
        <div class="sidebar-icon">
            <img src="images/quill.png" alt="quill" class="icon-image">
            <span class="tooltip">Prepare a Draft</span>
        </div>
    </div>
    
    <div class="main-content">
        <h1 class="logo">ResearchAssistant</h1>
        
        <div class="topic-header">
            <div class="topic-name">Topic Name</div>
            <div class="topic-suffix">Idea Generation</div>
        </div>
        
        <div class="research-section">
            <div class="section-title">Research Topic</div>
            <textarea class="research-textarea" placeholder="Briefly describe your research topic to help generate research ideas..."></textarea>
        </div>
        
        <div class="section-title">Upload PDFs for Analysis</div>
        <div class="upload-area">
            <input type="file" id="pdf-upload" multiple accept=".pdf">
            <svg class="upload-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"/>
            </svg>
            <p class="upload-text">Drag & Drop PDF files here or click to browse</p>
            <p class="upload-subtext">You can upload multiple PDF files for analysis (research papers, articles, etc.)</p>
        </div>
        
        <div class="file-list" id="file-list">
            <!-- Files will be listed here -->
        </div>
        
        <div style="margin-top: 20px;">
            <button id="generate-button" class="action-button">Generate Research Ideas</button>
            <button id="clear-button" class="action-button" style="background-color: #f2e8d8;">Clear All</button>
        </div>
        
        <div id="ideas-container" class="ideas-container">
            <div class="section-title">Generated Research Ideas</div>
            
            <!-- Ideas will be populated here -->
        </div>
        
        <div class="loading-overlay" id="loading-overlay">
            <div class="loading-spinner"></div>
            <p class="loading-text">Analyzing PDFs & Generating Ideas...</p>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Get elements
            const topicNameElement = document.querySelector('.topic-name');
            const researchTextarea = document.querySelector('.research-textarea');
            const fileUpload = document.getElementById('pdf-upload');
            const fileList = document.getElementById('file-list');
            const generateButton = document.getElementById('generate-button');
            const clearButton = document.getElementById('clear-button');
            const ideasContainer = document.getElementById('ideas-container');
            const loadingOverlay = document.getElementById('loading-overlay');
            
            // Get the topic name from localStorage
            const topicName = localStorage.getItem('topicName') || 'Research Topic';
            topicNameElement.textContent = topicName;
            
            // Store uploaded files
            let uploadedFiles = [];
            
            // Handle file upload
            fileUpload.addEventListener('change', function(e) {
                const files = e.target.files;
                
                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    
                    // Check if it's a PDF
                    if (file.type !== 'application/pdf') {
                        alert('Only PDF files are allowed');
                        continue;
                    }
                    
                    // Add to array
                    uploadedFiles.push(file);
                    
                    // Add to UI
                    addFileToList(file);
                }
            });
            
            // Add file to the list
            function addFileToList(file) {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                
                // Format file size
                const fileSize = formatFileSize(file.size);
                
                fileItem.innerHTML = `
                    <svg class="file-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z"/>
                        <path d="M14 3v5h5M16 13H8v-1h8v1zm0 2H8v-1h8v1zm-3 2H8v-1h5v1z"/>
                    </svg>
                    <div class="file-info">
                        <div class="file-name">${file.name}</div>
                        <div class="file-size">${fileSize}</div>
                    </div>
                    <svg class="file-remove" data-name="${file.name}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                    </svg>
                `;
                
                fileList.appendChild(fileItem);
                
                // Add remove event
                const removeButton = fileItem.querySelector('.file-remove');
                removeButton.addEventListener('click', function() {
                    const fileName = this.getAttribute('data-name');
                    removeFile(fileName);
                    fileItem.remove();
                });
            }
            
            // Remove file from array
            function removeFile(fileName) {
                uploadedFiles = uploadedFiles.filter(file => file.name !== fileName);
            }
            
            // Format file size
            function formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }
            
            // Generate ideas button
            generateButton.addEventListener('click', function() {
                if (uploadedFiles.length === 0) {
                    alert('Please upload at least one PDF file');
                    return;
                }
                
                // Show loading
                loadingOverlay.classList.add('shown');
                
                // Simulate processing (in a real app, this would send files to backend)
                setTimeout(function() {
                    // Hide loading
                    loadingOverlay.classList.remove('shown');
                    
                    // Generate mock ideas based on topic
                    const topic = researchTextarea.value.trim() || topicName;
                    generateIdeas(topic);
                    
                    // Show ideas
                    ideasContainer.style.display = 'block';
                    
                    // Scroll to ideas
                    ideasContainer.scrollIntoView({ behavior: 'smooth' });
                }, 3000);
            });
            
            // Clear button
            clearButton.addEventListener('click', function() {
                // Clear files
                uploadedFiles = [];
                fileList.innerHTML = '';
                
                // Clear textarea
                researchTextarea.value = '';
                
                // Hide ideas
                ideasContainer.style.display = 'none';
                ideasContainer.innerHTML = '<div class="section-title">Generated Research Ideas</div>';
            });
            
            // Generate ideas based on topic
            function generateIdeas(topic) {
                ideasContainer.innerHTML = '<div class="section-title">Generated Research Ideas</div>';
                
                // Create mock ideas (in a real app, these would come from analyzed PDFs)
                const ideas = [
                    {
                        title: `Exploring ${topic} through Meta-Analysis`,
                        description: `Conduct a comprehensive meta-analysis of existing studies on ${topic} to identify patterns, gaps, and future research directions.`,
                        tags: ['Meta-Analysis', 'Literature Review', 'Research Gaps']
                    },
                    {
                        title: `${topic} in Different Cultural Contexts`,
                        description: `Investigate how ${topic} manifests in various cultural contexts and what factors influence these differences.`,
                        tags: ['Cross-Cultural', 'Comparative Analysis', 'Global Perspective']
                    },
                    {
                        title: `Technological Innovations in ${topic}`,
                        description: `Explore recent technological advancements that have impacted ${topic} and propose new applications or improvements.`,
                        tags: ['Technology', 'Innovation', 'Applications']
                    },
                    {
                        title: `Ethical Considerations in ${topic} Research`,
                        description: `Analyze ethical challenges and considerations when conducting research on ${topic}, including privacy concerns, consent issues, and potential societal impacts.`,
                        tags: ['Ethics', 'Research Methods', 'Policy']
                    },
                    {
                        title: `${topic} in Educational Settings`,
                        description: `Investigate the applications and implications of ${topic} in educational contexts, from primary education to higher learning institutions.`,
                        tags: ['Education', 'Pedagogy', 'Learning']
                    }
                ];
                
                // Add ideas to container
                ideas.forEach(idea => {
                    const ideaCard = document.createElement('div');
                    ideaCard.className = 'idea-card';
                    
                    let tagsHTML = '';
                    idea.tags.forEach(tag => {
                        tagsHTML += `<span class="idea-tag">${tag}</span>`;
                    });
                    
                    ideaCard.innerHTML = `
                        <div class="idea-title">${idea.title}</div>
                        <div class="idea-description">${idea.description}</div>
                        <div class="idea-tags">
                            ${tagsHTML}
                        </div>
                    `;
                    
                    ideasContainer.appendChild(ideaCard);
                });
            }
            
            // Map tooltips (or any identifier) to page URLs
            const pageMap = {
                "Home": "index.html",
                "Literature Review": "literature-review.html",
                "Generate Ideas": "idea-generation.html",
                "Prepare a Draft": "draft-preparation.html"
            };

            // Select all sidebar icons
            document.querySelectorAll('.sidebar-icon').forEach(icon => {
                const tooltip = icon.querySelector('.tooltip');
                if (tooltip && pageMap[tooltip.textContent]) {
                    icon.addEventListener('click', () => {
                        window.location.href = pageMap[tooltip.textContent];
                    });
                }
            });
            
            // Also allow drag and drop
            const uploadArea = document.querySelector('.upload-area');
            
            uploadArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.style.borderColor = '#d6a76b';
                this.style.backgroundColor = '#f9f6f0';
            });
            
            uploadArea.addEventListener('dragleave', function(e) {
                e.preventDefault();
                this.style.borderColor = '#e0c8a0';
                this.style.backgroundColor = 'transparent';
            });
            
            uploadArea.addEventListener('drop', function(e) {
                e.preventDefault();
                this.style.borderColor = '#e0c8a0';
                this.style.backgroundColor = 'transparent';
                
                const files = e.dataTransfer.files;
                
                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    
                    // Check if it's a PDF
                    if (file.type !== 'application/pdf') {
                        alert('Only PDF files are allowed');
                        continue;
                    }
                    
                    // Add to array
                    uploadedFiles.push(file);
                    
                    // Add to UI
                    addFileToList(file);
                }
            });
        });
    </script>
</body>
</html>